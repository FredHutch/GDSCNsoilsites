% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getdata.R
\name{getdata}
\alias{getdata}
\title{#' Scrubs data according to faculty requests. This is an interactive process that
#' could likely be automated using a GitHub Action Google Sheet pull at some point.
#'
#' @param infile Character string specifying the path to the input CSV file containing raw data
#' @param outfile Character string specifying the path where the scrubbed data will be saved
#'
#' @return A \code{data.frame} containing the processed data with:
#'   - Filtered rows based on public sharing permissions
#'   - Masked EPA3051, Mehlich3, pH, buffer pH, OM_by_LOI_pct, and GPS measurements
#'   - Preserved data structure and column names
#'
#' @examples
#' scrubdata(infile = "BioDIGS Sample Data and Kit Request MASTER - ALL_SAMPLES.csv", outfile = "data/snapshots/BioDIGS_20250514.csv")
scrubdata <- function(infile, outfile) {
scrubbed_data <-
read.csv(infile) \%>\%
# Remove records not cleared for public sharing
filter(public_ok != "not yet provided") \%>\%
# Mask soil measurements for NO SOIL DATA records (as NA)
mutate(
across(
ends_with("EPA3051") |
ends_with("Mehlich3") |
water_pH | A.E_Buffer_pH | OM_by_LOI_pct,
~ case_when(public_ok == "GPS OK ; NO SOIL DATA" ~ NA, TRUE ~ .)
)
)  \%>\%
# Mask all measurements including GPS for records without GPS approval
mutate(
across(
ends_with("EPA3051") |
ends_with("Mehlich3") |
water_pH | A.E_Buffer_pH | OM_by_LOI_pct | gps,
~ case_when(public_ok == "NO GPS ; NO SOIL DATA" ~ NA, TRUE ~ .)
)
)}
\usage{
getdata(dataset = "sites")
}
\arguments{
\item{measure}{Which dataset? Can be \code{sites}, \code{soil}, or \code{seq} data.}
}
\value{
Soil data \code{data.frame}
}
\description{
#' Scrubs data according to faculty requests. This is an interactive process that
#' could likely be automated using a GitHub Action Google Sheet pull at some point.
#'
#' @param infile Character string specifying the path to the input CSV file containing raw data
#' @param outfile Character string specifying the path where the scrubbed data will be saved
#'
#' @return A \code{data.frame} containing the processed data with:
#'   - Filtered rows based on public sharing permissions
#'   - Masked EPA3051, Mehlich3, pH, buffer pH, OM_by_LOI_pct, and GPS measurements
#'   - Preserved data structure and column names
#'
#' @examples
#' scrubdata(infile = "BioDIGS Sample Data and Kit Request MASTER - ALL_SAMPLES.csv", outfile = "data/snapshots/BioDIGS_20250514.csv")
scrubdata <- function(infile, outfile) {
scrubbed_data <-
read.csv(infile) \%>\%
# Remove records not cleared for public sharing
filter(public_ok != "not yet provided") \%>\%
# Mask soil measurements for NO SOIL DATA records (as NA)
mutate(
across(
ends_with("EPA3051") |
ends_with("Mehlich3") |
water_pH | A.E_Buffer_pH | OM_by_LOI_pct,
~ case_when(public_ok == "GPS OK ; NO SOIL DATA" ~ NA, TRUE ~ .)
)
)  \%>\%
# Mask all measurements including GPS for records without GPS approval
mutate(
across(
ends_with("EPA3051") |
ends_with("Mehlich3") |
water_pH | A.E_Buffer_pH | OM_by_LOI_pct | gps,
~ case_when(public_ok == "NO GPS ; NO SOIL DATA" ~ NA, TRUE ~ .)
)
)
}
\section{Save processed data}{
write.csv(scrubbed_data, outfile)
}

\section{Notify if overwriting existing file}{

}

\examples{
getdata()
getdata(dataset = "soil")
}
